// api/protobufs/user.proto
syntax = "proto3";

package user;

// Go package path for generated code
option go_package = "github.com/datngth03/ecommerce-go-app/pkg/client/user;user_client";

// =======================
// Service Definition
// =======================
service UserService {
  // User account operations
  rpc RegisterUser(RegisterUserRequest) returns (RegisterUserResponse);
  rpc LoginUser(LoginUserRequest) returns (LoginUserResponse);
  rpc GetUserByEmail(GetUserByEmailRequest) returns (GetUserByEmailResponse);

  // Profile operations
  rpc GetUserProfile(GetUserProfileRequest) returns (UserProfileResponse);
  rpc UpdateUserProfile(UpdateUserProfileRequest) returns (UserProfileResponse);

  // Password management
  rpc ChangePassword(ChangePasswordRequest) returns (ChangePasswordResponse);
  rpc ResetPassword(ResetPasswordRequest) returns (ResetPasswordResponse);

  // Address management
  rpc AddAddress(AddAddressRequest) returns (AddressResponse);
  rpc UpdateAddress(UpdateAddressRequest) returns (AddressResponse);
  rpc DeleteAddress(DeleteAddressRequest) returns (DeleteAddressResponse);
  rpc ListAddresses(ListAddressesRequest) returns (ListAddressesResponse);

  // Order history
  rpc GetOrderHistory(GetOrderHistoryRequest) returns (GetOrderHistoryResponse);
}

// =======================
// User Account Messages
// =======================
message RegisterUserRequest {
  string email = 1;
  string password = 2;
  string full_name = 3;
}

message RegisterUserResponse {
  string user_id = 1;
  string message = 2;
}

message LoginUserRequest {
  string email = 1;
  string password = 2;
}

message LoginUserResponse {
  string user_id = 1;
  string access_token = 2;
  string refresh_token = 3;
  int64 expires_in = 4;
}

message GetUserByEmailRequest {
  string email = 1;
}

message GetUserByEmailResponse {
  UserProfileResponse user = 1;
}

// =======================
// Profile Messages
// =======================
message GetUserProfileRequest {
  string user_id = 1;
}

message UpdateUserProfileRequest {
  string user_id = 1;
  string full_name = 2;
  string phone_number = 3;
  string address = 4;
}

message UserProfileResponse {
  string user_id = 1;
  string email = 2;
  string full_name = 3;
  string phone_number = 4;
  repeated Address addresses = 5;
  // Add more fields if needed
}

// =======================
// Password Management
// =======================
message ChangePasswordRequest {
  string user_id = 1;
  string old_password = 2;
  string new_password = 3;
}

message ChangePasswordResponse {
  string message = 1;
}

message ResetPasswordRequest {
  string email = 1;
}

message ResetPasswordResponse {
  string message = 1;
}

// =======================
// Address Management
// =======================
message Address {
  string id = 1;
  string full_name = 2;
  string phone_number = 3;
  string street_address = 4;
  string city = 5;
  string postal_code = 6;
  string country = 7;
  bool is_default = 8;
}

message AddAddressRequest {
  string user_id = 1;
  Address address = 2;
}

message UpdateAddressRequest {
  string user_id = 1;
  Address address = 2;
}

message DeleteAddressRequest {
  string user_id = 1;
  string address_id = 2;
}

message AddressResponse {
  Address address = 1;
}

message DeleteAddressResponse {
  string message = 1;
}

message ListAddressesRequest {
  string user_id = 1;
}

message ListAddressesResponse {
  repeated Address addresses = 1;
}

// =======================
// Order History
// =======================
message Order {
  string order_id = 1;
  int64 order_date = 2;
  string status = 3;
  double total_amount = 4;
}

message GetOrderHistoryRequest {
  string user_id = 1;
}

message GetOrderHistoryResponse {
  repeated Order orders = 1;
}